# 性能对比（完整流程，批量 testEmails）

说明：每轮均从零开始执行"读取 → 解析/构建 → 对 testEmails（10 个邮箱）全部查询"，循环 100 次，统计平均用时与总命中数。

测试脚本：`tests/performance-test.js`

## 本次结果

| 方法              | 首轮构建时间 | 首轮查询时间(×10) | 平均每轮总时间 | 总成功查询 |
| ----------------- | ------------ | ----------------- | -------------- | ---------- |
| JSON 存储方式     | 20.36ms      | 0.11ms            | 16.25ms        | 800/1000   |
| 文件树-原始遍历   | 157.69ms     | 0.11ms            | 134.16ms       | 800/1000   |
| 文件树-按路径直查 | 0.01ms       | 0.15ms            | 0.03ms         | 800/1000   |

结论：

- JSON 方式整体表现稳定，适合常规从零开始的完整流程；
- 文件树-原始遍历受限于大量文件系统扫描，完整流程耗时较大；
- 文件树-按路径直查无需预构建，按目录规则直接映射路径并 existsSync 检测，完整流程最快；
- 三种方式的查询命中一致（与测试数据集一致）。

## 路径映射规则（按路径直查）

- harvard.edu → swot/lib/domains/edu/harvard.txt
- strath.ac.uk → swot/lib/domains/uk/ac/strath.txt

若需要在直查命中后返回学校名称，可在命中文件后 readFileSync(filePath) 解析名称行。

> 文件树-按路径直查的方法不必预构建映射，性能更好，但是考虑到 npm 包并不适合这种结构，包含这么多文件可能会出现其他问题，还是决定打包成 json 数据

- npm 包包含大量小文件（数千个 .txt）（68M）
- 安装速度慢
- 可能触发文件系统限制
- 不符合 npm 最佳实践